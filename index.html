<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue Layout (Force Loader Exit)</title>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <style>
        :root { --h: 60px; --f: 40px; --s: 200px; --primary: #42b883; }
        body, html { margin: 0; padding: 0; height: 100%; font-family: sans-serif; overflow: hidden; }

        /* ローダーのスタイル */
        #loader {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #ffffff; display: flex; flex-direction: column;
            justify-content: center; align-items: center; z-index: 9999;
        }
        .spinner {
            width: 40px; height: 40px; border: 4px solid #f3f3f3;
            border-top: 4px solid var(--primary); border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* レイアウト */
        #app {
            display: grid;
            grid-template-areas: "header header" "sidebar main" "footer footer";
            grid-template-rows: var(--h) 1fr var(--f);
            grid-template-columns: var(--s) 1fr;
            height: 100vh;
        }
        [v-cloak] { display: none !important; }

        header { grid-area: header; background: #35495e; color: white; display: flex; align-items: center; padding: 0 20px; }
        nav { grid-area: sidebar; background: #f4f4f4; border-right: 1px solid #ddd; padding: 20px; }
        main { grid-area: main; background: white; padding: 20px; overflow-y: auto; }
        footer { grid-area: footer; background: #222; color: #777; display: flex; align-items: center; justify-content: center; }
    </style>
</head>
<body>

    <div id="loader">
        <div class="spinner"></div>
        <p>Loading...</p>
    </div>

    <div id="app" v-cloak>
        <header><h2>App Title</h2></header>
        <nav><ul><li>Dashboard</li><li>Settings</li></ul></nav>
        <main>
            <h1>Main Content</h1>
            <p>Vue.jsが正常に起動しました。</p>
        </main>
        <footer>&copy; 2026 Layout</footer>
    </div>

    <script>
        // 安全装置: 5秒経ってもVueが起動しない場合は強制的にローダーを消す
        setTimeout(() => {
            const loader = document.getElementById('loader');
            if (loader && loader.style.display !== 'none') {
                console.warn("Vue loading slow or failed. Forcing loader removal.");
                loader.style.display = 'none';
            }
        }, 5000);

        // Vue の起動チェック
        window.onload = () => {
            if (typeof Vue === 'undefined') {
                alert("Vue.jsを読み込めませんでした。ネット接続を確認してください。");
                document.getElementById('loader').innerHTML = "Failed to load library.";
                return;
            }

            const { createApp } = Vue;
            const app = createApp({
                mounted() {
                    // Vueがマウントされたら即座に消す
                    const loader = document.getElementById('loader');
                    loader.style.transition = "opacity 0.3s";
                    loader.style.opacity = "0";
                    setTimeout(() => { loader.style.display = 'none'; }, 300);
                }
            });
            app.mount('#app');
        };
    </script>
</body>
</html>